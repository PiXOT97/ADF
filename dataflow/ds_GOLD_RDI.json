{
	"name": "ds_GOLD_RDI",
	"properties": {
		"folder": {
			"name": "ds_PROFI/ds_GOLD"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_main_ParquetPath",
						"type": "DatasetReference"
					},
					"name": "InputTransactions"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "RemoveNull",
					"description": "Remove Null BrandId,LocationId, TransactionId, SkuId, ProductId"
				},
				{
					"name": "AddColumns"
				}
			],
			"scriptLines": [
				"source(output(",
				"          transactionId as long,",
				"          receiptId as long,",
				"          actionType as string,",
				"          locationId as integer,",
				"          locationName as string,",
				"          clientId as long,",
				"          mediumType as string,",
				"          externalBrandId as integer,",
				"          brandName as string,",
				"          externalProductId as integer,",
				"          productName as string,",
				"          skuId as integer,",
				"          skuName as string,",
				"          barcode as long,",
				"          paymentMode as string,",
				"          quantity as double,",
				"          price as double,",
				"          discount as double,",
				"          grossRetailAmt as double,",
				"          grossTransAmt as double,",
				"          netRetailAmt as double,",
				"          netTransAmt as double,",
				"          date as string,",
				"          timestamp as string,",
				"          transactionFile as string,",
				"          transactionFileDate as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     format: 'parquet') ~> InputTransactions",
				"InputTransactions filter(!isNull(transactionId) && !isNan(transactionId) && \r",
				"!isNull(locationId) && !isNan(locationId) && \r",
				"!isNull(externalBrandId) && !isNan(externalBrandId) && \r",
				"!isNull(skuId) && !isNan(skuId) && \r",
				"!isNull(externalProductId) && !isNan(externalProductId) &&\r",
				"quantity >= 0) ~> RemoveNull",
				"RemoveNull derive(isPromotion = iif(discount>0,1,0)) ~> AddColumns"
			]
		}
	}
}